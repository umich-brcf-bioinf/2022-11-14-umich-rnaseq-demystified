<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />

<meta name="date" content="2022-10-26" />

<title>Module 09: Sample QC</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link rel="shortcut icon" href="favicon-16x16.png" />
<!--
Favicon from
https://twemoji.twitter.com/
https://favicon.io/emoji-favicons/dna/
-->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RNA-Seq Demystified</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Module00_Introduction.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Sequence QC
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module01_Warming_Up.html">Warming up</a>
    </li>
    <li>
      <a href="Module02a_Sequence_QC.html">Sequence QC</a>
    </li>
    <li>
      <a href="Module02b_Trimming.html">Trimming</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Alignment
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module03a_Reference_Genomes.html">Reference Genomes</a>
    </li>
    <li>
      <a href="Module03b_Alignment.html">Alignment</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Quantification
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module04_Alignment_QC_and_Quantification.html">Alignment QC and Quantification</a>
    </li>
    <li>
      <a href="Module05_Additional_Details.html">Optional: Additional details</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Groups/Model
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module06_DEAnalysisSetup.html">DE Introduction</a>
    </li>
    <li>
      <a href="Module07_DESeq2Init.html">DE Initialization</a>
    </li>
    <li>
      <a href="Module08_DESeq2DE.html">DE Normalization and Modeling</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Expression plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module09_SampleQCViz.html">Sample QC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Diff Expression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module10_DEComparisons.html">DE Testing</a>
    </li>
    <li>
      <a href="Module11_DEVisualizations.html">DE Visualization and Annotation</a>
    </li>
    <li>
      <a href="Module11X_BonusContent.html">Bonus content</a>
    </li>
  </ul>
</li>
<li>
  <a href="Module99_Wrap_up.html">Wrap up</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Module 09: Sample QC</h1>
<h4 class="author">UM Bioinformatics Core</h4>
<h4 class="date">2022-10-26</h4>

</div>


<style type="text/css">
body, td {
   font-size: 18px;
}
code.r{
  font-size: 12px;
}
pre {
  font-size: 12px
}
</style>
<blockquote>
<h1 id="objectives" class="unlisted unnumbered">Objectives</h1>
<ul>
<li>Generate common QC visualizations</li>
<li>Understand how to interpret QC visualizations</li>
<li>Understand when to revise the model used in the DESeq2
initialization</li>
<li>Understand the pitfalls of post-hoc analysis</li>
<li>Describe the causes and implications of batch effect or other QC
issues in an RNA-Seq experiment</li>
</ul>
</blockquote>
<div id="differential-expression-workflow"
class="section level1 unlisted unnumbered">
<h1 class="unlisted unnumbered">Differential Expression Workflow</h1>
<p>Prior to testing for differential expression between our comparisons
of interest, we’ll first generate plots that will assess how well our
samples match up with our expectations (based on their treatment groups)
and what we might expect to see from our differential expression
comparisons.</p>
<p><img src="images/wayfinder/slides/Slide10.png"
style="width:75.0%" /></p>
<hr />
</div>
<div id="qc-visualizations" class="section level1">
<h1>QC Visualizations</h1>
<p>We have discussed some aspects of quality control assessment at the
sequencing data level. Today we will outline sample-level and gene-level
quality control assessments to determine what we might expect for our
differential expression comparisons.</p>
<p>To do this, we will first assess the similarity of our samples by
using principal component analysis (PCA). This will allow us to
determine how well patterns in the data fits our expectations from the
experiments design and possible sources of variation.</p>
<p>Other common visualizations that we generate for our analyses include
expression heatmaps, sample correlation heatmaps, and boxplots of raw
and/or normalized counts, the code for which (due to time restrictions)
can be found as bonus content through the materials for today and in the
bonus content module.</p>
</div>
<div id="principal-component-analysis" class="section level1">
<h1>Principal Component Analysis</h1>
<p>A common and very useful plot for evaluating how well our samples
cluster by treatment groups are Principal Component Analysis (PCA)
plots. PCA is used to emphasize variation and bring out patterns in
large datasets by using dimensionality redution.</p>
<p>This image from <a
href="https://blog.bioturing.com/2018/06/14/principal-component-analysis-explained-simply/">a
helpful step by step explaination of PCA</a> helps to illustrate the
principal component projections for two genes measured in approximately
60 mouse samples. Generally, this process is repeated and after each
gene’s contribution to a principal component or weight is determined,
the expression and weight are summed across genes for each sample to
calculate a value for each principal component.</p>
<p><img src="images/Blog_pca_6b.png" /></p>
<blockquote>
<p><strong>Note</strong>: A more detailed overview of the PCA procedure
is outlined in <a
href="https://hbctraining.github.io/DGE_workshop/lessons/principal_component_analysis.html">a
Harvard Chan Bioinformatic Core training module</a> and is based on a
more thorough description presented in a <a
href="https://www.youtube.com/watch?v=_UVHneBUBW0">StatQuest’s
video</a>. Additionally, this <a
href="https://towardsdatascience.com/principal-component-analysis-3c39fbf5cb9d">TowardsDataScience
blog post</a> goes through the math behind PCAs.</p>
</blockquote>
<div id="interpreting-pca-plots" class="section level2">
<h2>Interpreting PCA plots</h2>
<p>For most bulk RNA-seq experiments, we expect the majority of the
total variance to be explained by the first two or three principal
components.</p>
<p><img src="images/PCAplot_Fancy_rlog_ko.Tx.png"
style="width:75.0%" /></p>
<p>In this plot, which we will generate for our data later, principal
component 1 (PC1) explains ~80% of the variance in our data while
principal component 2 (PC2) explains ~12% of the variance, which fits
that expections.</p>
<blockquote>
<h1 id="question" class="unlisted unnumbered">Question</h1>
<p>How might we interpret the variance explained by each principal
component in the context of the labeled sample points?</p>
</blockquote>
<p>For more information, this <a
href="https://blog.bioturing.com/2018/06/14/principal-component-analysis-explained-simply/">helpful
overview of PCA basics</a> walks through both the generation and
interpretation of PCA plots.</p>
</div>
<div id="evaluating-batch-effects-or-confounders"
class="section level2">
<h2>Evaluating batch effects or confounders</h2>
<p>PCA plots are also useful for evaluating the impact of factors other
than the experimental treatment or group. At times, batch effects can be
quite obvious, such as this example from the <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html">DESeq2
vignette</a>, where samples within each treatment group look staggered
into two subgroups.</p>
<p><img src="images/PCA1_DESeq2Vignette.png" /></p>
<p>It turns out this experiment contained samples sequenced single-end
and paired-end. If we color only by sequencing run type (paired-end
vs. single-end), we see that PC2 (29% of variance) is primarily
explained by this technical covariate.</p>
<p><img src="images/PCA2_DESeq2Vignette.png" /></p>
<p>However, the samples are clearly seperated by experimental condition
on PC1 <strong>and</strong> since we have non-confounded batches, if we
saw this pattern in our data we could incorporate the technical
covariate into our model design, such as outlined in the <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#multi-factor-designs">DESeq2
vignette</a>.</p>
<details>
<summary>
<em>Click for complex design discussion</em>
</summary>
In experiments with more complex designs, such as when there are
interesecting/multiple treatment conditions, it can be less clear what
covariants are influencing expression, such as illustrated from <a
href="http://www.molmine.com/magma/global_analysis/batch_effect.html">this
documenation for a microarray analysis tool</a>. From the PCA labeled by
experimental treatment, we see that samples from the treatment group do
not cluster together and that there is high variance across all
treatment groups. <img src="images/batch_ex1b.jpg" /> However, when
the plot is color coded by the technical batches of probe labeling, we
see that the patterns in the data are better explained by batch than the
experimental conditions. <img src="images/batch_ex1c.jpg" />
</details>
<p><br></p>
</div>
</div>
<div id="create-a-pca" class="section level1">
<h1>Create a PCA</h1>
<p>We’ve already loaded the libraries we need for this module. We have
also thought ahead in the previous module and created the
<code>outputs/figures</code> and <code>outputs/tables</code>
directories.</p>
<p>Below, we will plot the rlog normalized data and generate the PCA
projections for the top 500 using the <code>plotPCA</code> function from
DESeq2, specifying <code>condition</code> as the condition of interest,
and view the simple plot generated by the function.</p>
<pre class="r"><code>pca_plot = plotPCA(rld, intgroup = c(&#39;condition&#39;), ntop = 500)
pca_plot</code></pre>
<p><img src="fig/09-PCArlog3-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>The samples don’t appear to cluster too tightly on their
<code>condition</code>, but we do observe that they do separate in PC2.
With real data, it is often the case that data doesn’t cluster as well
as you’d expect, or that the covariate of interest is not associated
with the first (or sometimes second or third) principal component. That
doesn’t necessarily mean the experiment is a failure, but it does raise
questions such as “What is associated with PC1?” Sometimes we can’t
answer a question like this if we don’t have any sample phenotype to
color in the PCA.</p>
<p>Next, let’s save this plot as a file in our
<code>outputs/figures</code> folder. The “base R” way is to:</p>
<pre class="r"><code>pdf(file = file.path(&#39;outputs&#39;, &#39;figures&#39;, &#39;PCA_rlog_condition.pdf&#39;), width = 6, height = 6)
pca_plot
dev.off()</code></pre>
<p>Alternatively, since <code>pca_plot</code> is a <code>ggplot</code>,
we can use <code>ggsave()</code>.</p>
<pre class="r"><code>ggsave(
    filename = file.path(&#39;outputs&#39;, &#39;figures&#39;, &#39;PCA_rlog_condition.pdf&#39;),
    plot = pca_plot,
    width = 6, height = 6, units = &#39;in&#39;)</code></pre>
<blockquote>
<h1 id="exercise---customize-the-pca"
class="unlisted unnumbered">Exercise - Customize the PCA</h1>
<p>Since the <code>pca_plot</code> object is a <code>ggplot</code>–you
can see this with <code>class(pca_plot)</code>–we can use what we
learned at the end of the Computational Foundations Workshop to modify
this plot as we might see necessary. Try doing the following to the
<code>pca_plot</code>:</p>
<ol style="list-style-type: decimal">
<li>Add a title and subtitle to the plot using the <code>labs()</code>
function.</li>
<li>Change the theme of the plot with <code>theme_bw()</code>.</li>
<li>Challenge: Change the legend title to “Condition”. Hint, you can do
this with the <code>labs()</code> function too, using the corresponding
aesthetic mapping (e.g. “color”).</li>
</ol>
<p>Remember <code>ggplot2</code> adds plot components in layers, and you
can add additional layers with the <code>+</code> sign. So if the plot
already exists as an object, as <code>pca_plot</code> does in this case,
you can add to it like <code>pca_plot + ...</code></p>
</blockquote>
<details>
<summary>
Solution
</summary>
<p>Here is one possible answer:</p>
<pre class="r"><code>pca_plot +
    labs(
        title = &#39;PCA Plot&#39;,
        subtitle = &#39;Top 500 variable genes&#39;,
        color = &#39;Condition&#39;) +
    theme_bw()</code></pre>
<img src="fig/09-customize_pca_exercise-1.png" width="816" style="display: block; margin: auto;" />
</details>
<p><br></p>
<p><strong>Checkpoint</strong>: <em>If you generated and saved the
<code>pca_plot</code> PCA plot, please indicate with the green ‘check’
button. Otherwise, please use use the red ‘x’ button in your zoom
reaction panel to have this step repeated.</em></p>
<blockquote>
<h1 id="breakout-exercise-1---imagine-a-heatmap"
class="unlisted unnumbered">Breakout Exercise 1 - Imagine a heatmap</h1>
<p>Plotting the expression values across all samples for the top
variable genes in an experiment can help to visualize how samples
cluster together by their expression profiles. When combined with
phenotypic data, it can help show how samples with different treatments
behave relative to one another. Let’s work through this exercise in
small groups and generate a heatmap of the data we’ve been working
with.</p>
<p><a href="Module09a_breakout.html">Link to exercise</a></p>
</blockquote>
</div>
<div id="download-plots" class="section level1">
<h1>Download plots</h1>
<p>Rstudio server allows us to download files through the interactive
file panel on the right side. If we navigate into the plot subfolder and
select the <code>PCAplot_rlog_condition.pdf</code> or the file, we can
then click the blue gear symbol labeled <code>More</code> and select
<code>Export...</code>. We should see a prompt regarding the name of the
file and if we click <code>Download</code> the file should show up in
your local “Downloads” folder.</p>
</div>
<div id="optional-content" class="section level1">
<h1>Optional Content</h1>
<details>
<summary>
<em>Click for example code for generating a ScreePlot</em>
</summary>
<p>A screeplot is a way to visualize the variance explained by all
principal components. To generate a scree plot, the PCA results need to
be used independently of plotting, such as described by <a
href="https://statquest.org/pca-clearly-explained/">this statquest
post</a> and replicated below.</p>
<pre class="r"><code># generate PCA loadings
pca = prcomp(t(assay(rld)), scale=TRUE)

## get the scree information
pca.var = pca$sdev^2
scree = pca.var/sum(pca.var)
p = barplot((scree[1:10]*100), main=&quot;Scree Plot&quot;, xlab=&quot;Principal Component&quot;, ylab=&quot;Percent Variation&quot;)</code></pre>
<p><img src="fig/09-ScreePlot-1.png" width="816" style="display: block; margin: auto;" /></p>
<pre class="r"><code>print(p)</code></pre>
<pre><code>      [,1]
 [1,]  0.7
 [2,]  1.9
 [3,]  3.1
 [4,]  4.3
 [5,]  5.5
 [6,]  6.7
 [7,]  7.9
 [8,]  9.1
 [9,] 10.3
[10,] 11.5</code></pre>
We can see that the majority (~65%) of the variance across our samples
is explained by the first three principal components, giving us some
additional confidence regarding the quality of our data. In these scree
plot examples from BioTuring, the plot on the left fits what we would
expect for a dataset with high signal from the experimental treatment,
where the majority of the variance is explained by the first few
principal components. The plot on the right illustrates a scenario where
the variance is distributed across many components, which could be due
to low signal from the experimental treatment, complex experimental
design, or confounding factors. image: <img
src="images/proportion-of-variance-blog-horz.jpg" />
</details>
<p><br></p>
<details>
<summary>
<em>Click for code for a plot of dispersion estimates</em>
</summary>
<p>We can visualize the <strong>dispersion estimates</strong> with the
<code>plotDispEsts</code> function. This plot shows the the DESeq2
normalization results for our data, which centers on shrinking the
variance across all genes to better fit the expected spread at a given
expression level.</p>
<pre class="r"><code>plotDispEsts(dds)</code></pre>
<p><img src="fig/09-CheckDispersions-1.png" width="816" style="display: block; margin: auto;" />
Above is the raw data plotted in black, the fitted (or expected)
dispersion in red, and the normalized data with scaled variance in blue.
Since we have fairly small sample sizes for each condition, we see
shrinkage for many genes but a reasonable correlation between the
expression level and dispersions.</p>
This <a
href="https://hbctraining.github.io/DGE_workshop/lessons/04_DGE_DESeq2_analysis.html">HBC
tutorial</a> has a more detailed overview of estimating size factors,
estimating gene dispersion, and the shrinkage procedure, as well as
examples of concerning dispersion plots that may suggest reassessing
quality of the experimental data.
</details>
<p><br></p>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>In this section, we:</p>
<ul>
<li>Discussed variance within treatment groups</li>
<li>Discussed technical artifacts, including batches</li>
<li>Learned to generate PCA plots</li>
</ul>
<hr />
</div>
<div id="sources" class="section level1">
<h1>Sources</h1>
<ul>
<li>HBC QC tutorial: <a
href="https://hbctraining.github.io/DGE_workshop/lessons/03_DGE_QC_analysis.html"
class="uri">https://hbctraining.github.io/DGE_workshop/lessons/03_DGE_QC_analysis.html</a></li>
<li>Detailed Heatmap tutorial from Galaxy: <a
href="https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-heatmap2/tutorial.html"
class="uri">https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-heatmap2/tutorial.html</a></li>
<li>PCA Overview: <a
href="https://blog.bioturing.com/2018/06/14/principal-component-analysis-explained-simply/"
class="uri">https://blog.bioturing.com/2018/06/14/principal-component-analysis-explained-simply/</a></li>
</ul>
<hr />
<p>These materials have been adapted and extended from materials listed
above. These are open access materials distributed under the terms of
the <a href="http://creativecommons.org/licenses/by/4.0/">Creative
Commons Attribution license (CC BY 4.0)</a>, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original
author and source are credited.</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiTW9kdWxlIDA5OiBTYW1wbGUgUUMiCmF1dGhvcjogIlVNIEJpb2luZm9ybWF0aWNzIENvcmUiCmRhdGU6ICJgciBTeXMuRGF0ZSgpYCIKb3V0cHV0OgogICAgICAgIGh0bWxfZG9jdW1lbnQ6CiAgICAgICAgICAgIGluY2x1ZGVzOgogICAgICAgICAgICAgICAgaW5faGVhZGVyOiBoZWFkZXIuaHRtbAogICAgICAgICAgICB0aGVtZTogcGFwZXIKICAgICAgICAgICAgdG9jOiB0cnVlCiAgICAgICAgICAgIHRvY19kZXB0aDogNAogICAgICAgICAgICB0b2NfZmxvYXQ6IHRydWUKICAgICAgICAgICAgbnVtYmVyX3NlY3Rpb25zOiBmYWxzZQogICAgICAgICAgICBmaWdfY2FwdGlvbjogdHJ1ZQogICAgICAgICAgICBtYXJrZG93bjogR0ZNCiAgICAgICAgICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKLS0tCgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgpib2R5LCB0ZCB7CiAgIGZvbnQtc2l6ZTogMThweDsKfQpjb2RlLnJ7CiAgZm9udC1zaXplOiAxMnB4Owp9CnByZSB7CiAgZm9udC1zaXplOiAxMnB4Cn0KPC9zdHlsZT4KCmBgYHtyLCBpbmNsdWRlID0gRkFMU0V9CnNvdXJjZSgiLi4vYmluL2NodW5rLW9wdGlvbnMuUiIpCmtuaXRyX2ZpZ19wYXRoKCIwOS0iKQpgYGAKCj4gIyBPYmplY3RpdmVzIHsudW5saXN0ZWQgLnVubnVtYmVyZWR9Cj4gKiBHZW5lcmF0ZSBjb21tb24gUUMgdmlzdWFsaXphdGlvbnMKPiAqIFVuZGVyc3RhbmQgaG93IHRvIGludGVycHJldCBRQyB2aXN1YWxpemF0aW9ucwo+ICogVW5kZXJzdGFuZCB3aGVuIHRvIHJldmlzZSB0aGUgbW9kZWwgdXNlZCBpbiB0aGUgREVTZXEyIGluaXRpYWxpemF0aW9uCj4gKiBVbmRlcnN0YW5kIHRoZSBwaXRmYWxscyBvZiBwb3N0LWhvYyBhbmFseXNpcwo+ICogRGVzY3JpYmUgdGhlIGNhdXNlcyBhbmQgaW1wbGljYXRpb25zIG9mIGJhdGNoIGVmZmVjdCBvciBvdGhlciBRQyBpc3N1ZXMgaW4gYW4gUk5BLVNlcSBleHBlcmltZW50CgoKYGBge3IgTW9kdWxlcywgZXZhbD1UUlVFLCBlY2hvPUZBTFNFLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQpsaWJyYXJ5KERFU2VxMikKbGlicmFyeShnZ3Bsb3QyKQpsaWJyYXJ5KHRpZHlyKQpsaWJyYXJ5KGRwbHlyKQpsaWJyYXJ5KG1hdHJpeFN0YXRzKQpsaWJyYXJ5KGdncmVwZWwpCmxpYnJhcnkocGhlYXRtYXApCmxpYnJhcnkoUkNvbG9yQnJld2VyKQojIGxvYWQoInJkYXRhL1J1bm5pbmdEYXRhLlJEYXRhIikKYGBgCgojIERpZmZlcmVudGlhbCBFeHByZXNzaW9uIFdvcmtmbG93IHsudW5saXN0ZWQgLnVubnVtYmVyZWR9CgpQcmlvciB0byB0ZXN0aW5nIGZvciBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiBiZXR3ZWVuIG91ciBjb21wYXJpc29ucyBvZiBpbnRlcmVzdCwgd2UnbGwgZmlyc3QgZ2VuZXJhdGUgcGxvdHMgdGhhdCB3aWxsIGFzc2VzcyBob3cgd2VsbCBvdXIgc2FtcGxlcyBtYXRjaCB1cCB3aXRoIG91ciBleHBlY3RhdGlvbnMgKGJhc2VkIG9uIHRoZWlyIHRyZWF0bWVudCBncm91cHMpIGFuZCB3aGF0IHdlIG1pZ2h0IGV4cGVjdCB0byBzZWUgZnJvbSBvdXIgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24gY29tcGFyaXNvbnMuCgohW10oLi9pbWFnZXMvd2F5ZmluZGVyL3dheWZpbmRlci1TYW1wbGVRQ1Zpei5wbmcpe3dpZHRoPTc1JX0KCi0tLQoKIyBRQyBWaXN1YWxpemF0aW9ucwoKV2UgaGF2ZSBkaXNjdXNzZWQgc29tZSBhc3BlY3RzIG9mIHF1YWxpdHkgY29udHJvbCBhc3Nlc3NtZW50IGF0IHRoZSBzZXF1ZW5jaW5nIGRhdGEgbGV2ZWwuIFRvZGF5IHdlIHdpbGwgb3V0bGluZSBzYW1wbGUtbGV2ZWwgYW5kIGdlbmUtbGV2ZWwgcXVhbGl0eSBjb250cm9sIGFzc2Vzc21lbnRzIHRvIGRldGVybWluZSB3aGF0IHdlIG1pZ2h0IGV4cGVjdCBmb3Igb3VyIGRpZmZlcmVudGlhbCBleHByZXNzaW9uIGNvbXBhcmlzb25zLgoKVG8gZG8gdGhpcywgd2Ugd2lsbCBmaXJzdCBhc3Nlc3MgdGhlIHNpbWlsYXJpdHkgb2Ygb3VyIHNhbXBsZXMgYnkgdXNpbmcgcHJpbmNpcGFsIGNvbXBvbmVudCBhbmFseXNpcyAoUENBKS4gVGhpcyB3aWxsIGFsbG93IHVzIHRvIGRldGVybWluZSBob3cgd2VsbCBwYXR0ZXJucyBpbiB0aGUgZGF0YSBmaXRzIG91ciBleHBlY3RhdGlvbnMgZnJvbSB0aGUgZXhwZXJpbWVudHMgZGVzaWduIGFuZCBwb3NzaWJsZSBzb3VyY2VzIG9mIHZhcmlhdGlvbi4KCk90aGVyIGNvbW1vbiB2aXN1YWxpemF0aW9ucyB0aGF0IHdlIGdlbmVyYXRlIGZvciBvdXIgYW5hbHlzZXMgaW5jbHVkZSBleHByZXNzaW9uIGhlYXRtYXBzLCBzYW1wbGUgY29ycmVsYXRpb24gaGVhdG1hcHMsIGFuZCBib3hwbG90cyBvZiByYXcgYW5kL29yIG5vcm1hbGl6ZWQgY291bnRzLCB0aGUgY29kZSBmb3Igd2hpY2ggKGR1ZSB0byB0aW1lIHJlc3RyaWN0aW9ucykgY2FuIGJlIGZvdW5kIGFzIGJvbnVzIGNvbnRlbnQgdGhyb3VnaCB0aGUgbWF0ZXJpYWxzIGZvciB0b2RheSBhbmQgaW4gdGhlIGJvbnVzIGNvbnRlbnQgbW9kdWxlLgoKIyBQcmluY2lwYWwgQ29tcG9uZW50IEFuYWx5c2lzCgpBIGNvbW1vbiBhbmQgdmVyeSB1c2VmdWwgcGxvdCBmb3IgZXZhbHVhdGluZyBob3cgd2VsbCBvdXIgc2FtcGxlcyBjbHVzdGVyIGJ5IHRyZWF0bWVudCBncm91cHMgYXJlIFByaW5jaXBhbCBDb21wb25lbnQgQW5hbHlzaXMgKFBDQSkgcGxvdHMuIFBDQSBpcyB1c2VkIHRvIGVtcGhhc2l6ZSB2YXJpYXRpb24gYW5kIGJyaW5nIG91dCBwYXR0ZXJucyBpbiBsYXJnZSBkYXRhc2V0cyBieSB1c2luZyBkaW1lbnNpb25hbGl0eSByZWR1dGlvbi4KClRoaXMgaW1hZ2UgZnJvbQpbYSBoZWxwZnVsIHN0ZXAgYnkgc3RlcCBleHBsYWluYXRpb24gb2YgUENBXShodHRwczovL2Jsb2cuYmlvdHVyaW5nLmNvbS8yMDE4LzA2LzE0L3ByaW5jaXBhbC1jb21wb25lbnQtYW5hbHlzaXMtZXhwbGFpbmVkLXNpbXBseS8pIGhlbHBzIHRvIGlsbHVzdHJhdGUgdGhlIHByaW5jaXBhbCBjb21wb25lbnQgcHJvamVjdGlvbnMgZm9yIHR3byBnZW5lcyBtZWFzdXJlZCBpbiBhcHByb3hpbWF0ZWx5IDYwIG1vdXNlIHNhbXBsZXMuIEdlbmVyYWxseSwgdGhpcyBwcm9jZXNzIGlzIHJlcGVhdGVkIGFuZCBhZnRlciBlYWNoIGdlbmUncyBjb250cmlidXRpb24gdG8gYSBwcmluY2lwYWwgY29tcG9uZW50IG9yIHdlaWdodCBpcyBkZXRlcm1pbmVkLCB0aGUgZXhwcmVzc2lvbiBhbmQgd2VpZ2h0IGFyZSBzdW1tZWQgYWNyb3NzIGdlbmVzIGZvciBlYWNoIHNhbXBsZSB0byBjYWxjdWxhdGUgYSB2YWx1ZSBmb3IgZWFjaCBwcmluY2lwYWwgY29tcG9uZW50LgoKIVtdKC4vaW1hZ2VzL0Jsb2dfcGNhXzZiLnBuZykKCj4qKk5vdGUqKjogQSBtb3JlIGRldGFpbGVkIG92ZXJ2aWV3IG9mIHRoZSBQQ0EgcHJvY2VkdXJlIGlzIG91dGxpbmVkIGluIFthIEhhcnZhcmQgQ2hhbiBCaW9pbmZvcm1hdGljIENvcmUgdHJhaW5pbmcgbW9kdWxlXShodHRwczovL2hiY3RyYWluaW5nLmdpdGh1Yi5pby9ER0Vfd29ya3Nob3AvbGVzc29ucy9wcmluY2lwYWxfY29tcG9uZW50X2FuYWx5c2lzLmh0bWwpIGFuZCBpcyBiYXNlZCBvbiBhIG1vcmUgdGhvcm91Z2ggZGVzY3JpcHRpb24gcHJlc2VudGVkIGluIGEgW1N0YXRRdWVzdOKAmXMgdmlkZW9dKGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9X1VWSG5lQlVCVzApLiBBZGRpdGlvbmFsbHksIHRoaXMgW1Rvd2FyZHNEYXRhU2NpZW5jZSBibG9nIHBvc3RdKGh0dHBzOi8vdG93YXJkc2RhdGFzY2llbmNlLmNvbS9wcmluY2lwYWwtY29tcG9uZW50LWFuYWx5c2lzLTNjMzlmYmY1Y2I5ZCkgZ29lcyB0aHJvdWdoIHRoZSBtYXRoIGJlaGluZCBQQ0FzLgoKIyMgSW50ZXJwcmV0aW5nIFBDQSBwbG90cwoKRm9yIG1vc3QgYnVsayBSTkEtc2VxIGV4cGVyaW1lbnRzLCB3ZSBleHBlY3QgdGhlIG1ham9yaXR5IG9mIHRoZSB0b3RhbCB2YXJpYW5jZSB0byBiZSBleHBsYWluZWQgYnkgdGhlIGZpcnN0IHR3byBvciB0aHJlZSBwcmluY2lwYWwgY29tcG9uZW50cy4KCiFbXShpbWFnZXMvUENBcGxvdF9GYW5jeV9ybG9nX2tvLlR4LnBuZyl7d2lkdGg9NzUlfQoKSW4gdGhpcyBwbG90LCB3aGljaCB3ZSB3aWxsIGdlbmVyYXRlIGZvciBvdXIgZGF0YSBsYXRlciwgcHJpbmNpcGFsIGNvbXBvbmVudCAxIChQQzEpIGV4cGxhaW5zIH44MCUgb2YgdGhlIHZhcmlhbmNlIGluIG91ciBkYXRhIHdoaWxlIHByaW5jaXBhbCBjb21wb25lbnQgMiAoUEMyKSBleHBsYWlucyB+MTIlIG9mIHRoZSB2YXJpYW5jZSwgd2hpY2ggZml0cyB0aGF0IGV4cGVjdGlvbnMuCgo+ICMgUXVlc3Rpb24gey51bmxpc3RlZCAudW5udW1iZXJlZH0KPgo+IEhvdyBtaWdodCB3ZSBpbnRlcnByZXQgdGhlIHZhcmlhbmNlIGV4cGxhaW5lZCBieSBlYWNoIHByaW5jaXBhbCBjb21wb25lbnQgaW4gdGhlIGNvbnRleHQgb2YgdGhlIGxhYmVsZWQgc2FtcGxlIHBvaW50cz8KCkZvciBtb3JlIGluZm9ybWF0aW9uLCB0aGlzIFtoZWxwZnVsIG92ZXJ2aWV3IG9mIFBDQSBiYXNpY3NdKGh0dHBzOi8vYmxvZy5iaW90dXJpbmcuY29tLzIwMTgvMDYvMTQvcHJpbmNpcGFsLWNvbXBvbmVudC1hbmFseXNpcy1leHBsYWluZWQtc2ltcGx5Lykgd2Fsa3MgdGhyb3VnaCBib3RoIHRoZSBnZW5lcmF0aW9uIGFuZCBpbnRlcnByZXRhdGlvbiBvZiBQQ0EgcGxvdHMuCgojIyBFdmFsdWF0aW5nIGJhdGNoIGVmZmVjdHMgb3IgY29uZm91bmRlcnMKClBDQSBwbG90cyBhcmUgYWxzbyB1c2VmdWwgZm9yIGV2YWx1YXRpbmcgdGhlIGltcGFjdCBvZiBmYWN0b3JzIG90aGVyIHRoYW4gdGhlIGV4cGVyaW1lbnRhbCB0cmVhdG1lbnQgb3IgZ3JvdXAuIEF0IHRpbWVzLCBiYXRjaCBlZmZlY3RzIGNhbiBiZSBxdWl0ZSBvYnZpb3VzLCBzdWNoIGFzIHRoaXMgZXhhbXBsZSBmcm9tIHRoZSBbREVTZXEyIHZpZ25ldHRlXShodHRwOi8vYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9kZXZlbC9iaW9jL3ZpZ25ldHRlcy9ERVNlcTIvaW5zdC9kb2MvREVTZXEyLmh0bWwpLCB3aGVyZSBzYW1wbGVzIHdpdGhpbiBlYWNoIHRyZWF0bWVudCBncm91cCBsb29rIHN0YWdnZXJlZCBpbnRvIHR3byBzdWJncm91cHMuCgohW10oLi9pbWFnZXMvUENBMV9ERVNlcTJWaWduZXR0ZS5wbmcpCgpJdCB0dXJucyBvdXQgdGhpcyBleHBlcmltZW50IGNvbnRhaW5lZCBzYW1wbGVzIHNlcXVlbmNlZCBzaW5nbGUtZW5kIGFuZCBwYWlyZWQtZW5kLiBJZiB3ZSBjb2xvciBvbmx5IGJ5IHNlcXVlbmNpbmcgcnVuIHR5cGUgKHBhaXJlZC1lbmQgdnMuIHNpbmdsZS1lbmQpLCB3ZSBzZWUgdGhhdCBQQzIgKDI5JSBvZiB2YXJpYW5jZSkgaXMgcHJpbWFyaWx5IGV4cGxhaW5lZCBieSB0aGlzIHRlY2huaWNhbCBjb3ZhcmlhdGUuCgohW10oLi9pbWFnZXMvUENBMl9ERVNlcTJWaWduZXR0ZS5wbmcpCgpIb3dldmVyLCB0aGUgc2FtcGxlcyBhcmUgY2xlYXJseSBzZXBlcmF0ZWQgYnkgZXhwZXJpbWVudGFsIGNvbmRpdGlvbiBvbiBQQzEgKiphbmQqKiBzaW5jZSB3ZSBoYXZlIG5vbi1jb25mb3VuZGVkIGJhdGNoZXMsIGlmIHdlIHNhdyB0aGlzIHBhdHRlcm4gaW4gb3VyIGRhdGEgd2UgY291bGQgaW5jb3Jwb3JhdGUgdGhlIHRlY2huaWNhbCBjb3ZhcmlhdGUgaW50byBvdXIgbW9kZWwgZGVzaWduLCBzdWNoIGFzIG91dGxpbmVkIGluIHRoZSBbREVTZXEyIHZpZ25ldHRlXShodHRwOi8vYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9kZXZlbC9iaW9jL3ZpZ25ldHRlcy9ERVNlcTIvaW5zdC9kb2MvREVTZXEyLmh0bWwjbXVsdGktZmFjdG9yLWRlc2lnbnMpLgoKPGRldGFpbHM+CiAgICA8c3VtbWFyeT4qQ2xpY2sgZm9yIGNvbXBsZXggZGVzaWduIGRpc2N1c3Npb24qPC9zdW1tYXJ5PgogICAgSW4gZXhwZXJpbWVudHMgd2l0aCBtb3JlIGNvbXBsZXggZGVzaWducywgc3VjaCBhcyB3aGVuIHRoZXJlIGFyZSBpbnRlcmVzZWN0aW5nL211bHRpcGxlIHRyZWF0bWVudCBjb25kaXRpb25zLCBpdCBjYW4gYmUgbGVzcyBjbGVhciB3aGF0IGNvdmFyaWFudHMgYXJlIGluZmx1ZW5jaW5nIGV4cHJlc3Npb24sIHN1Y2ggYXMgaWxsdXN0cmF0ZWQgZnJvbSBbdGhpcyBkb2N1bWVuYXRpb24gZm9yIGEgbWljcm9hcnJheSBhbmFseXNpcyB0b29sXShodHRwOi8vd3d3Lm1vbG1pbmUuY29tL21hZ21hL2dsb2JhbF9hbmFseXNpcy9iYXRjaF9lZmZlY3QuaHRtbCkuCiAgICBGcm9tIHRoZSBQQ0EgbGFiZWxlZCBieSBleHBlcmltZW50YWwgdHJlYXRtZW50LCB3ZSBzZWUgdGhhdCBzYW1wbGVzIGZyb20gdGhlIHRyZWF0bWVudCBncm91cCBkbyBub3QgY2x1c3RlciB0b2dldGhlciBhbmQgdGhhdCB0aGVyZSBpcyBoaWdoIHZhcmlhbmNlIGFjcm9zcyBhbGwgdHJlYXRtZW50IGdyb3Vwcy4KICAgICFbXSguL2ltYWdlcy9iYXRjaF9leDFiLmpwZykKICAgIEhvd2V2ZXIsIHdoZW4gdGhlIHBsb3QgaXMgY29sb3IgY29kZWQgYnkgdGhlIHRlY2huaWNhbCBiYXRjaGVzIG9mIHByb2JlIGxhYmVsaW5nLCB3ZSBzZWUgdGhhdCB0aGUgcGF0dGVybnMgaW4gdGhlIGRhdGEgYXJlIGJldHRlciBleHBsYWluZWQgYnkgYmF0Y2ggdGhhbiB0aGUgZXhwZXJpbWVudGFsIGNvbmRpdGlvbnMuCiAgICAhW10oLi9pbWFnZXMvYmF0Y2hfZXgxYy5qcGcpCjwvZGV0YWlscz4KPGJyPgoKIyBDcmVhdGUgYSBQQ0EKCldlJ3ZlIGFscmVhZHkgbG9hZGVkIHRoZSBsaWJyYXJpZXMgd2UgbmVlZCBmb3IgdGhpcyBtb2R1bGUuIFdlIGhhdmUgYWxzbyB0aG91Z2h0IGFoZWFkIGluIHRoZSBwcmV2aW91cyBtb2R1bGUgYW5kIGNyZWF0ZWQgdGhlIGBvdXRwdXRzL2ZpZ3VyZXNgIGFuZCBgb3V0cHV0cy90YWJsZXNgIGRpcmVjdG9yaWVzLgoKQmVsb3csIHdlIHdpbGwgcGxvdCB0aGUgcmxvZyBub3JtYWxpemVkIGRhdGEgYW5kIGdlbmVyYXRlIHRoZSBQQ0EgcHJvamVjdGlvbnMgZm9yIHRoZSB0b3AgNTAwIHVzaW5nIHRoZSBgcGxvdFBDQWAgZnVuY3Rpb24gZnJvbSBERVNlcTIsIHNwZWNpZnlpbmcgYGNvbmRpdGlvbmAgYXMgdGhlIGNvbmRpdGlvbiBvZiBpbnRlcmVzdCwgYW5kIHZpZXcgdGhlIHNpbXBsZSBwbG90IGdlbmVyYXRlZCBieSB0aGUgZnVuY3Rpb24uCgpgYGB7ciBQQ0FybG9nM30KcGNhX3Bsb3QgPSBwbG90UENBKHJsZCwgaW50Z3JvdXAgPSBjKCdjb25kaXRpb24nKSwgbnRvcCA9IDUwMCkKcGNhX3Bsb3QKYGBgCgpUaGUgc2FtcGxlcyBkb24ndCBhcHBlYXIgdG8gY2x1c3RlciB0b28gdGlnaHRseSBvbiB0aGVpciBgY29uZGl0aW9uYCwgYnV0IHdlIGRvIG9ic2VydmUgdGhhdCB0aGV5IGRvIHNlcGFyYXRlIGluIFBDMi4gV2l0aCByZWFsIGRhdGEsIGl0IGlzIG9mdGVuIHRoZSBjYXNlIHRoYXQgZGF0YSBkb2Vzbid0IGNsdXN0ZXIgYXMgd2VsbCBhcyB5b3UnZCBleHBlY3QsIG9yIHRoYXQgdGhlIGNvdmFyaWF0ZSBvZiBpbnRlcmVzdCBpcyBub3QgYXNzb2NpYXRlZCB3aXRoIHRoZSBmaXJzdCAob3Igc29tZXRpbWVzIHNlY29uZCBvciB0aGlyZCkgcHJpbmNpcGFsIGNvbXBvbmVudC4gVGhhdCBkb2Vzbid0IG5lY2Vzc2FyaWx5IG1lYW4gdGhlIGV4cGVyaW1lbnQgaXMgYSBmYWlsdXJlLCBidXQgaXQgZG9lcyByYWlzZSBxdWVzdGlvbnMgc3VjaCBhcyAiV2hhdCBpcyBhc3NvY2lhdGVkIHdpdGggUEMxPyIgU29tZXRpbWVzIHdlIGNhbid0IGFuc3dlciBhIHF1ZXN0aW9uIGxpa2UgdGhpcyBpZiB3ZSBkb24ndCBoYXZlIGFueSBzYW1wbGUgcGhlbm90eXBlIHRvIGNvbG9yIGluIHRoZSBQQ0EuCgpOZXh0LCBsZXQncyBzYXZlIHRoaXMgcGxvdCBhcyBhIGZpbGUgaW4gb3VyIGBvdXRwdXRzL2ZpZ3VyZXNgIGZvbGRlci4gVGhlICJiYXNlIFIiIHdheSBpcyB0bzoKCmBgYHtyIHNhdmVfcGNhX2Jhc2UsIGV2YWwgPSBGQUxTRX0KcGRmKGZpbGUgPSBmaWxlLnBhdGgoJ291dHB1dHMnLCAnZmlndXJlcycsICdQQ0FfcmxvZ19jb25kaXRpb24ucGRmJyksIHdpZHRoID0gNiwgaGVpZ2h0ID0gNikKcGNhX3Bsb3QKZGV2Lm9mZigpCmBgYAoKQWx0ZXJuYXRpdmVseSwgc2luY2UgYHBjYV9wbG90YCBpcyBhIGBnZ3Bsb3RgLCB3ZSBjYW4gdXNlIGBnZ3NhdmUoKWAuCgpgYGB7ciBzYXZlX3BjYV9nZ3NhdmUsIGV2YWwgPSBGQUxTRX0KZ2dzYXZlKAogICAgZmlsZW5hbWUgPSBmaWxlLnBhdGgoJ291dHB1dHMnLCAnZmlndXJlcycsICdQQ0FfcmxvZ19jb25kaXRpb24ucGRmJyksCiAgICBwbG90ID0gcGNhX3Bsb3QsCiAgICB3aWR0aCA9IDYsIGhlaWdodCA9IDYsIHVuaXRzID0gJ2luJykKYGBgCgo+ICMgRXhlcmNpc2UgLSBDdXN0b21pemUgdGhlIFBDQSB7LnVubGlzdGVkIC51bm51bWJlcmVkfQo+Cj4gU2luY2UgdGhlIGBwY2FfcGxvdGAgb2JqZWN0IGlzIGEgYGdncGxvdGAtLXlvdSBjYW4gc2VlIHRoaXMgd2l0aCBgY2xhc3MocGNhX3Bsb3QpYC0td2UgY2FuIHVzZSB3aGF0IHdlIGxlYXJuZWQgYXQgdGhlIGVuZCBvZiB0aGUgQ29tcHV0YXRpb25hbCBGb3VuZGF0aW9ucyBXb3Jrc2hvcCB0byBtb2RpZnkgdGhpcyBwbG90IGFzIHdlIG1pZ2h0IHNlZSBuZWNlc3NhcnkuIFRyeSBkb2luZyB0aGUgZm9sbG93aW5nIHRvIHRoZSBgcGNhX3Bsb3RgOgo+Cj4gMS4gQWRkIGEgdGl0bGUgYW5kIHN1YnRpdGxlIHRvIHRoZSBwbG90IHVzaW5nIHRoZSBgbGFicygpYCBmdW5jdGlvbi4KPiAyLiBDaGFuZ2UgdGhlIHRoZW1lIG9mIHRoZSBwbG90IHdpdGggYHRoZW1lX2J3KClgLgo+IDMuIENoYWxsZW5nZTogQ2hhbmdlIHRoZSBsZWdlbmQgdGl0bGUgdG8gIkNvbmRpdGlvbiIuIEhpbnQsIHlvdSBjYW4gZG8gdGhpcyB3aXRoIHRoZSBgbGFicygpYCBmdW5jdGlvbiB0b28sIHVzaW5nIHRoZSBjb3JyZXNwb25kaW5nIGFlc3RoZXRpYyBtYXBwaW5nIChlLmcuICJjb2xvciIpLgo+Cj4gUmVtZW1iZXIgYGdncGxvdDJgIGFkZHMgcGxvdCBjb21wb25lbnRzIGluIGxheWVycywgYW5kIHlvdSBjYW4gYWRkIGFkZGl0aW9uYWwgbGF5ZXJzIHdpdGggdGhlIGArYCBzaWduLiBTbyBpZiB0aGUgcGxvdCBhbHJlYWR5IGV4aXN0cyBhcyBhbiBvYmplY3QsIGFzIGBwY2FfcGxvdGAgZG9lcyBpbiB0aGlzIGNhc2UsIHlvdSBjYW4gYWRkIHRvIGl0IGxpa2UgYHBjYV9wbG90ICsgLi4uYAoKPGRldGFpbHM+CjxzdW1tYXJ5PlNvbHV0aW9uPC9zdW1tYXJ5PgoKSGVyZSBpcyBvbmUgcG9zc2libGUgYW5zd2VyOgoKYGBge3IgY3VzdG9taXplX3BjYV9leGVyY2lzZX0KcGNhX3Bsb3QgKwogICAgbGFicygKICAgICAgICB0aXRsZSA9ICdQQ0EgUGxvdCcsCiAgICAgICAgc3VidGl0bGUgPSAnVG9wIDUwMCB2YXJpYWJsZSBnZW5lcycsCiAgICAgICAgY29sb3IgPSAnQ29uZGl0aW9uJykgKwogICAgdGhlbWVfYncoKQpgYGAKPC9kZXRhaWxzPgo8YnI+CgoqKkNoZWNrcG9pbnQqKjogKklmIHlvdSBnZW5lcmF0ZWQgYW5kIHNhdmVkIHRoZSBgcGNhX3Bsb3RgIFBDQSBwbG90LCBwbGVhc2UgaW5kaWNhdGUgd2l0aCB0aGUgZ3JlZW4gJ2NoZWNrJyBidXR0b24uIE90aGVyd2lzZSwgcGxlYXNlIHVzZSAgdXNlIHRoZSByZWQgJ3gnIGJ1dHRvbiBpbiB5b3VyIHpvb20gcmVhY3Rpb24gcGFuZWwgdG8gaGF2ZSB0aGlzIHN0ZXAgcmVwZWF0ZWQuKgoKPiAjIEJyZWFrb3V0IEV4ZXJjaXNlIDEgLSBJbWFnaW5lIGEgaGVhdG1hcCB7LnVubGlzdGVkIC51bm51bWJlcmVkfQo+Cj4gUGxvdHRpbmcgdGhlIGV4cHJlc3Npb24gdmFsdWVzIGFjcm9zcyBhbGwgc2FtcGxlcyBmb3IgdGhlIHRvcCB2YXJpYWJsZSBnZW5lcyBpbiBhbiBleHBlcmltZW50IGNhbiBoZWxwIHRvIHZpc3VhbGl6ZSBob3cgc2FtcGxlcyBjbHVzdGVyIHRvZ2V0aGVyIGJ5IHRoZWlyIGV4cHJlc3Npb24gcHJvZmlsZXMuIFdoZW4gY29tYmluZWQgd2l0aCBwaGVub3R5cGljIGRhdGEsIGl0IGNhbiBoZWxwIHNob3cgaG93IHNhbXBsZXMgd2l0aCBkaWZmZXJlbnQgdHJlYXRtZW50cyBiZWhhdmUgcmVsYXRpdmUgdG8gb25lIGFub3RoZXIuIExldCdzIHdvcmsgdGhyb3VnaCB0aGlzIGV4ZXJjaXNlIGluIHNtYWxsIGdyb3VwcyBhbmQgZ2VuZXJhdGUgYSBoZWF0bWFwIG9mIHRoZSBkYXRhIHdlJ3ZlIGJlZW4gd29ya2luZyB3aXRoLgo+Cj4gW0xpbmsgdG8gZXhlcmNpc2VdKE1vZHVsZTA5YV9icmVha291dC5odG1sKQoKCiMgRG93bmxvYWQgcGxvdHMKClJzdHVkaW8gc2VydmVyIGFsbG93cyB1cyB0byBkb3dubG9hZCBmaWxlcyB0aHJvdWdoIHRoZSBpbnRlcmFjdGl2ZSBmaWxlIHBhbmVsIG9uIHRoZSByaWdodCBzaWRlLiBJZiB3ZSBuYXZpZ2F0ZSBpbnRvIHRoZSBwbG90IHN1YmZvbGRlciBhbmQgc2VsZWN0IHRoZSBgUENBcGxvdF9ybG9nX2NvbmRpdGlvbi5wZGZgIG9yIHRoZSAgZmlsZSwgd2UgY2FuIHRoZW4gY2xpY2sgdGhlIGJsdWUgZ2VhciBzeW1ib2wgbGFiZWxlZCBgTW9yZWAgYW5kIHNlbGVjdCBgRXhwb3J0Li4uYC4gV2Ugc2hvdWxkIHNlZSBhIHByb21wdCByZWdhcmRpbmcgdGhlIG5hbWUgb2YgdGhlIGZpbGUgYW5kIGlmIHdlIGNsaWNrIGBEb3dubG9hZGAgdGhlIGZpbGUgc2hvdWxkIHNob3cgdXAgaW4geW91ciBsb2NhbCAiRG93bmxvYWRzIiBmb2xkZXIuCgojIE9wdGlvbmFsIENvbnRlbnQKCjxkZXRhaWxzPgogICAgPHN1bW1hcnk+KkNsaWNrIGZvciBleGFtcGxlIGNvZGUgZm9yIGdlbmVyYXRpbmcgYSBTY3JlZVBsb3QqPC9zdW1tYXJ5PgogICAgIEEgc2NyZWVwbG90IGlzIGEgd2F5IHRvIHZpc3VhbGl6ZSB0aGUgdmFyaWFuY2UgZXhwbGFpbmVkIGJ5IGFsbCBwcmluY2lwYWwgY29tcG9uZW50cy4KICAgICBUbyBnZW5lcmF0ZSBhIHNjcmVlIHBsb3QsIHRoZSBQQ0EgcmVzdWx0cyBuZWVkIHRvIGJlIHVzZWQgaW5kZXBlbmRlbnRseSBvZiBwbG90dGluZywgc3VjaCBhcyBkZXNjcmliZWQgYnkgW3RoaXMgc3RhdHF1ZXN0IHBvc3RdKGh0dHBzOi8vc3RhdHF1ZXN0Lm9yZy9wY2EtY2xlYXJseS1leHBsYWluZWQvKSBhbmQgcmVwbGljYXRlZCBiZWxvdy4KCmBgYHtyIFNjcmVlUGxvdH0KIyBnZW5lcmF0ZSBQQ0EgbG9hZGluZ3MKcGNhID0gcHJjb21wKHQoYXNzYXkocmxkKSksIHNjYWxlPVRSVUUpCgojIyBnZXQgdGhlIHNjcmVlIGluZm9ybWF0aW9uCnBjYS52YXIgPSBwY2Ekc2Rldl4yCnNjcmVlID0gcGNhLnZhci9zdW0ocGNhLnZhcikKcCA9IGJhcnBsb3QoKHNjcmVlWzE6MTBdKjEwMCksIG1haW49IlNjcmVlIFBsb3QiLCB4bGFiPSJQcmluY2lwYWwgQ29tcG9uZW50IiwgeWxhYj0iUGVyY2VudCBWYXJpYXRpb24iKQpwcmludChwKQpgYGAKCiAgICBXZSBjYW4gc2VlIHRoYXQgdGhlIG1ham9yaXR5ICh+NjUlKSBvZiB0aGUgdmFyaWFuY2UgYWNyb3NzIG91ciBzYW1wbGVzIGlzIGV4cGxhaW5lZCBieSB0aGUgZmlyc3QgdGhyZWUgcHJpbmNpcGFsIGNvbXBvbmVudHMsIGdpdmluZyB1cyBzb21lIGFkZGl0aW9uYWwgY29uZmlkZW5jZSByZWdhcmRpbmcgdGhlIHF1YWxpdHkgb2Ygb3VyIGRhdGEuCiAgICBJbiB0aGVzZSBzY3JlZSBwbG90IGV4YW1wbGVzIGZyb20gQmlvVHVyaW5nLCB0aGUgcGxvdCBvbiB0aGUgbGVmdCBmaXRzIHdoYXQgd2Ugd291bGQgZXhwZWN0IGZvciBhIGRhdGFzZXQgd2l0aCBoaWdoIHNpZ25hbCBmcm9tIHRoZSBleHBlcmltZW50YWwgdHJlYXRtZW50LCB3aGVyZSB0aGUgbWFqb3JpdHkgb2YgdGhlIHZhcmlhbmNlIGlzIGV4cGxhaW5lZCBieSB0aGUgZmlyc3QgZmV3IHByaW5jaXBhbCBjb21wb25lbnRzLiBUaGUgcGxvdCBvbiB0aGUgcmlnaHQgaWxsdXN0cmF0ZXMgYSBzY2VuYXJpbyB3aGVyZSB0aGUgdmFyaWFuY2UgaXMgZGlzdHJpYnV0ZWQgYWNyb3NzIG1hbnkgY29tcG9uZW50cywgd2hpY2ggY291bGQgYmUgZHVlIHRvIGxvdyBzaWduYWwgZnJvbSB0aGUgZXhwZXJpbWVudGFsIHRyZWF0bWVudCwgY29tcGxleCBleHBlcmltZW50YWwgZGVzaWduLCBvciBjb25mb3VuZGluZyBmYWN0b3JzLgppbWFnZTogIVtdKC4vaW1hZ2VzL3Byb3BvcnRpb24tb2YtdmFyaWFuY2UtYmxvZy1ob3J6LmpwZykKPC9kZXRhaWxzPgo8YnI+Cgo8ZGV0YWlscz4KICAgIDxzdW1tYXJ5PipDbGljayBmb3IgY29kZSBmb3IgYSBwbG90IG9mIGRpc3BlcnNpb24gZXN0aW1hdGVzKjwvc3VtbWFyeT4KICAgIFdlIGNhbiB2aXN1YWxpemUgdGhlICoqZGlzcGVyc2lvbiBlc3RpbWF0ZXMqKiB3aXRoIHRoZSBgcGxvdERpc3BFc3RzYCBmdW5jdGlvbi4gVGhpcyBwbG90IHNob3dzIHRoZSB0aGUgREVTZXEyIG5vcm1hbGl6YXRpb24gcmVzdWx0cyBmb3Igb3VyIGRhdGEsIHdoaWNoIGNlbnRlcnMgb24gc2hyaW5raW5nIHRoZSB2YXJpYW5jZSBhY3Jvc3MgYWxsIGdlbmVzIHRvIGJldHRlciBmaXQgdGhlIGV4cGVjdGVkIHNwcmVhZCBhdCBhIGdpdmVuIGV4cHJlc3Npb24gbGV2ZWwuCmBgYHtyIENoZWNrRGlzcGVyc2lvbnN9CnBsb3REaXNwRXN0cyhkZHMpCmBgYAogICAgQWJvdmUgaXMgdGhlIHJhdyBkYXRhIHBsb3R0ZWQgaW4gYmxhY2ssIHRoZSBmaXR0ZWQgKG9yIGV4cGVjdGVkKSBkaXNwZXJzaW9uIGluIHJlZCwgYW5kIHRoZSBub3JtYWxpemVkIGRhdGEgd2l0aCBzY2FsZWQgdmFyaWFuY2UgaW4gYmx1ZS4gU2luY2Ugd2UgaGF2ZSBmYWlybHkgc21hbGwgc2FtcGxlIHNpemVzIGZvciBlYWNoIGNvbmRpdGlvbiwgd2Ugc2VlIHNocmlua2FnZSBmb3IgbWFueSBnZW5lcyBidXQgYSByZWFzb25hYmxlIGNvcnJlbGF0aW9uIGJldHdlZW4gdGhlIGV4cHJlc3Npb24gbGV2ZWwgYW5kIGRpc3BlcnNpb25zLgoKICAgIFRoaXMgW0hCQyB0dXRvcmlhbF0oaHR0cHM6Ly9oYmN0cmFpbmluZy5naXRodWIuaW8vREdFX3dvcmtzaG9wL2xlc3NvbnMvMDRfREdFX0RFU2VxMl9hbmFseXNpcy5odG1sKSBoYXMgYSBtb3JlIGRldGFpbGVkIG92ZXJ2aWV3IG9mIGVzdGltYXRpbmcgc2l6ZSBmYWN0b3JzLCBlc3RpbWF0aW5nIGdlbmUgZGlzcGVyc2lvbiwgYW5kIHRoZSBzaHJpbmthZ2UgcHJvY2VkdXJlLCBhcyB3ZWxsIGFzIGV4YW1wbGVzIG9mIGNvbmNlcm5pbmcgZGlzcGVyc2lvbiBwbG90cyB0aGF0IG1heSBzdWdnZXN0IHJlYXNzZXNzaW5nIHF1YWxpdHkgb2YgdGhlIGV4cGVyaW1lbnRhbCBkYXRhLgo8L2RldGFpbHM+Cjxicj4KCiMgU3VtbWFyeQoKSW4gdGhpcyBzZWN0aW9uLCB3ZToKCiogRGlzY3Vzc2VkIHZhcmlhbmNlIHdpdGhpbiB0cmVhdG1lbnQgZ3JvdXBzCiogRGlzY3Vzc2VkIHRlY2huaWNhbCBhcnRpZmFjdHMsIGluY2x1ZGluZyBiYXRjaGVzCiogTGVhcm5lZCB0byBnZW5lcmF0ZSBQQ0EgcGxvdHMKCi0tLQoKIyBTb3VyY2VzCgoqIEhCQyBRQyB0dXRvcmlhbDogaHR0cHM6Ly9oYmN0cmFpbmluZy5naXRodWIuaW8vREdFX3dvcmtzaG9wL2xlc3NvbnMvMDNfREdFX1FDX2FuYWx5c2lzLmh0bWwKKiBEZXRhaWxlZCBIZWF0bWFwIHR1dG9yaWFsIGZyb20gR2FsYXh5OiBodHRwczovL3RyYWluaW5nLmdhbGF4eXByb2plY3Qub3JnL3RyYWluaW5nLW1hdGVyaWFsL3RvcGljcy90cmFuc2NyaXB0b21pY3MvdHV0b3JpYWxzL3JuYS1zZXEtdml6LXdpdGgtaGVhdG1hcDIvdHV0b3JpYWwuaHRtbAoqIFBDQSBPdmVydmlldzogaHR0cHM6Ly9ibG9nLmJpb3R1cmluZy5jb20vMjAxOC8wNi8xNC9wcmluY2lwYWwtY29tcG9uZW50LWFuYWx5c2lzLWV4cGxhaW5lZC1zaW1wbHkvCgpgYGB7ciBXcml0ZU91dC5SRGF0YSwgZXZhbD1GQUxTRSwgZWNobz1GQUxTRSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0KI0hpZGRlbiBjb2RlIGJsb2NrIHRvIHdyaXRlIG91dCBkYXRhIGZvciBrbml0dGluZwojIHNhdmUuaW1hZ2UoZmlsZSA9ICJyZGF0YS9SdW5uaW5nRGF0YS5SRGF0YSIpCmBgYAoKLS0tCgoKVGhlc2UgbWF0ZXJpYWxzIGhhdmUgYmVlbiBhZGFwdGVkIGFuZCBleHRlbmRlZCBmcm9tIG1hdGVyaWFscyBsaXN0ZWQgYWJvdmUuIFRoZXNlIGFyZSBvcGVuIGFjY2VzcyBtYXRlcmlhbHMgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBbQ3JlYXRpdmUgQ29tbW9ucyBBdHRyaWJ1dGlvbiBsaWNlbnNlIChDQyBCWSA0LjApXShodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS80LjAvKSwgd2hpY2ggcGVybWl0cyB1bnJlc3RyaWN0ZWQgdXNlLCBkaXN0cmlidXRpb24sIGFuZCByZXByb2R1Y3Rpb24gaW4gYW55IG1lZGl1bSwgcHJvdmlkZWQgdGhlIG9yaWdpbmFsIGF1dGhvciBhbmQgc291cmNlIGFyZSBjcmVkaXRlZC4K</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Module09_SampleQCViz.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
